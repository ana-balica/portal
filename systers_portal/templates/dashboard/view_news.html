{% extends "base.html" %}

{% load dashboard_extras %}
{% load guardian_tags %}

{% block head %}
  <script type="text/javascript" src="http://w.sharethis.com/button/buttons.js"></script>
  <script type="text/javascript">
    stLight.options({publisher: "340b978f-3a42-4f70-bb42-d639f57af637",
      doNotHash: true,
      doNotCopy: false,
      hashAddressBar: false,
      st_url: "{% url 'view_news' news.community.slug news.slug %}"
    });
  </script>
{% endblock %}

{% block title %} - {{ news.community }} - {{ news.title }}{% endblock %}
{% block content %}
  <div class="spacer"></div>
  <h2>{{ news.title }}</h2>
  <p class="meta-main">{{ news.date_modified }} | <a
            href="{% url 'view_user_profile' news.author.user.username %}">{{ news.author }}</a>
        </p>

  <div class="row">
  <div class="col-md-9">
    <hr>
    <div class="body">{{ news.content|safe }}</div>
    {% if news.tags %}
      <ul class="tag-pills">
        {% for tag in news.tags.all %}
          <li><span class="label label-info">{{ tag }}</span></li>
        {% endfor %}
      </ul>
    {% endif %}
    <div class="social-media">
      <span class='st_facebook_large' displayText='Facebook'></span>
      <span class='st_twitter_large' displayText='Tweet'></span>
      <span class='st_googleplus_large' displayText='Google +'></span>
      <span class='st_linkedin_large' displayText='LinkedIn'></span>
    </div>
    <hr>
    <div class="comments">
      {% include 'dashboard/comments.html' with posting=news type='news' %}
    </div>
  </div>

    <div class="col-md-3">
      <div class="sidebar-module sidebar-community">
        <h4>News actions</h4>
        <ol class="list-unstyled">
          {% if user.is_authenticated and user.is_active %}
            {% get_obj_perms request.user for news.community as "community_perms" %}
            {% if "change_community_news" in community_perms %}
              <li><a href="{% url 'edit_news' news.community.slug news.slug %}">Edit</a>
              </li>
            {% endif %}
            {% if "delete_community_news" in community_perms %}
              <li><a href="{% url 'delete_news' news.community.slug news.slug %}">Delete</a>
              </li>
            {% endif %}
            {% ifequal request.user.systeruser  news.community.community_admin %}
              {% if news.is_monitor %}
                <li><a href="{% url 'unmonitor_news' news.community.slug news.slug %}">Unwatch</a></li>
              {% else %}
                <li><a href="{% url 'monitor_news' news.community.slug news.slug %}">Watch</a></li>
              {% endif %}
            {% endifequal %}
          {% endif %}
          <li><a href="{% url 'show_community_news' news.community.slug %}">Back to {{ news.community }} news</a></li>
        </ol>
      </div>
    </div>
  </div>

{% endblock %}

{% block community_name %}{{ news.community }}{% endblock %}
